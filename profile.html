<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		
		<title>Startup NURE</title>
		
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">
		<link rel="stylesheet" href="styles.css">
		
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
		<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="css/style.css">
	</head>
	<body style="word-wrap: break-word;">
		<div class="yep_bg"><img src="photo/yep_bg.png"></div>
		
		<header class="sticky-top" style="background-color: white">
			<nav class="main-menu">
				<div class="menu_block">
					<a class="menu_yep" href="#"><img src="photo/yep.png" alt="Перейти до головної сторінки" height="40"></a>
					<a class="menu_item" href="#">YEP!STARTER</a>
					<a class="menu_item" href="#">STARTAP CLUB NURE</a>
					<a class="menu_item" href="Startups.html">СТАРТАПИ</a>
					<a class="menu_item" href="#">ПОДІЇ</a>
					<div class="menu_item sub_item">
						<a href="#">startuper2000 <img src="photo/temp_profile.jpg" height="20" style="border-radius: 30px; margin-left: 5px;"></a>
						<div class="submenu">
							<a class="submenu_item" href="#">МІЙ ПРОФІЛЬ</a>
							<a class="submenu_item" href="#">МОЇ СТАРТАПИ</a>
							<a class="submenu_item" href="#">МОЇ ПОДІЇ</a>
							<a class="submenu_item" href="login.html">ВИХІД</a>
						</div>
					</div>
					<a id="ntf" class="menu_ntf" href="#"><img src="photo/menu_ntf_black.png" height="20"></a>	
				</div>
			</nav>
		</header>
		
		<div class="content">
			
			<article class="card-body mx-auto">
				<div class="card" style="width: 100%">
					<div class="card-header">
						<div class="row">
							<div class="col my-auto">Профіль користувача <a id="username"></a></div>
							<div class="col text-right my-auto"><span id="membership"></span><span id="edit"></span><span id="ban"></span></div>
						</div>
					</div>
					
					<div class="card-body">
						<div class="row">
							<div class="col-3 border-right">
								<div class="card">
									<img id='photo' class="card-img-top" src="photo/temp_profile.jpg">
									
									<div class="card-header text-center">
										<i class="far fa-calendar-alt"></i><small class = "text-muted"> Реєстрація: <span id='registerDate'>10.10.2020</span> </small>
									</div>
									<div id='membership_status' class="card-header text-center"></div>
								</div>
							</div>
							
							<div class="col">
								<ul class="nav nav-tabs" id="profileTab" role="tablist">
									<li class="nav-item">
										<a class="nav-link active" id="common-tab" data-toggle="tab" href="#common" role="tab" aria-controls="common" aria-selected="true">Загальне</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" id="bio-tab" data-toggle="tab" href="#bio" role="tab" aria-controls="bio" aria-selected="false">Біографія</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false">Контакти</a>
									</li>
								</ul>
								<div class="tab-content" id="profileTabContent">
									<div class="tab-pane fade show active" id="common" role="tabpanel" aria-labelledby="common-tab">
										<div class="row m-2 border-bottom">
											<div class="col-6 my-auto"><h4 class = "text-muted"><i class="far fa-user"></i> Прізвище: </h4></div>
											<div class="col my-auto"><h4 id='secondName'><i class="text-muted">Інформація прихована</i></h4></div>
										</div>
										<div class="row m-2 border-bottom">
											<div class="col-6 my-auto"><h4 class = "text-muted"><i class="far fa-user"></i> Ім'я: </h4></div>
											<div class="col my-auto"><h4 id='firstName'><i class="text-muted">Інформація прихована</i></h4></div>
										</div>
										<div class="row m-2 border-bottom">
											<div class="col-6 my-auto"><h4 class = "text-muted"><i class="fas fa-transgender-alt"></i> Гендер: </h4></div>
											<div class="col my-auto"><h4 id='gender'><i class="text-muted">Інформація прихована</i></h4></div>
										</div>
										<div class="row m-2 border-bottom">
											<div class="col-6 my-auto"><h4 class = "text-muted"><i class="fas fa-birthday-cake"></i> День народження: </h4></div>
											<div class="col my-auto"><h4 id='birthday'><i class="text-muted">Інформація прихована</i></h4></div>
										</div>
									</div>
									<div class="tab-pane fade" id="bio" role="tabpanel" aria-labelledby="bio-tab">
										<div id='description' class="container m-2"><i class="text-muted">Інформація прихована</i></div>
									</div>
									<div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
										<div class="row m-2 border-bottom">
											<div class="col-5 my-auto"><h4 class = "text-muted"><i class="fas fa-phone"></i> Телефон: </h4></div>
											<div class="col my-auto"><h4 id='phone'><i class="text-muted">Інформація прихована</i></h4></div>
										</div>
										<div class="row m-2 border-bottom">
											<div class="col-5 my-auto"><h4 class = "text-muted"><i class="far fa-envelope"></i> Електронна пошта: </h4></div>
											<div class="col my-auto"><h4 id='email'><i class="text-muted">Інформація прихована</i></h4></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</article>
			
		</div>
		
	</body>
	
	<script>
	
		var url = new URL(window.location.href);
		var usrid = url.searchParams.get("user_id");
		
		if (usrid == null) {
			
			if (window.localStorage.getItem('user_id'))
				usrid = window.localStorage.getItem('user_id');
			else
				window.location.href = "startups.html?error=";//encodeURI(text)
		}

		fetch('http://eliasb13-001-site1.itempurl.com/api/Accounts/profile/' + usrid)
			.then(handleResponse)
			.then(function(data) {

				showProfile(data);
				
				if (url.searchParams.get('user_id') == window.localStorage.getItem('user_id'))
					showOwnProfile(data);
				
				if (window.localStorage.getItem('admin') == true)
					showForAdmin(data);
				
			});
			
		function showProfile(data) {
		
			document.getElementById('username').href = data.user_id;
			document.getElementById('username').innerHTML = data.login;
			document.getElementById('registerDate').innerHTML = data.registerDate.substr(0, 10);
				
			if (data.ban)
				document.getElementById('membership_status').innerHTML = '<small class = "text-danger"> Забанений користувач </small>';
			else if (data.membership == 1)
				document.getElementById('membership_status').innerHTML = '<small class = "text-success"> Член клубу </small>';
			else
				document.getElementById('membership_status').innerHTML = '<small class = "text-muted"> Звичайний користувач </small>';
			
			
			if (data.secondName)
				document.getElementById('secondName').innerHTML = data.secondName;
				
			if (data.firstName)
				document.getElementById('firstName').innerHTML = data.firstName;
				
			if (data.gender == 'Male')
				document.getElementById('gender').innerHTML = 'Чоловіча';
			else if (data.gender == 'Female')
				document.getElementById('gender').innerHTML = 'Жіноча';
			
			if (data.description)
				document.getElementById('description').innerHTML = data.description;
				
			if (data.photo)
				document.getElementById('photo').src = data.photo;
				
			if (data.birthday)
				document.getElementById('birthday').innerHTML = data.birthday;
			
			if (data.phone)
				document.getElementById('phone').innerHTML = data.phone;
				
			if (data.email)
				document.getElementById('email').innerHTML = data.email;
		
		}
		
		function showOwnProfile(data) {
		
			if (data.membership == 0)
				document.getElementById('membership').innerHTML = '<a href="request_membership">Стати членом <i class="fas fa-arrow-alt-circle-up"></i></a> ';
			else if (data.membership == 2) 
				document.getElementById('membership').innerHTML = '<span class="text-muted">Запит на членство надіслано</span> ';
				
			document.getElementById('edit').innerHTML= '<a href="edit_profile.php"><i class="fas fa-pencil-alt"></i></a>';
			
			showEverythingProfile(data);
		
		}
		
		function showForAdmin(data) {
		
			document.getElementById('membership').innerHTML = '<a class="text-success" href="add_member.php">Надати членство <i class="fas fa-arrow-alt-circle-up"></i></a>';
		
			document.getElementById('ban').innerHTML = '<a class="text-danger" href="ban">Забанити <i class="fas fa-ban"></i></a>';
			
			showEverythingProfile(data);
		
		}
		
		function handleResponse(response) {
			return response.text().then(text => {
				const data = text && JSON.parse(text);

				if (!response.ok) {
					const error = (data && data.message) || response.statusText;

					return Promise.reject(error);
				}

				return data;
			});
		}

	</script>
	
	
	<script>
	$(window).bind('scroll',function(e){
    parallaxScroll();
});
 
function parallaxScroll(){
    var scrolled = $(window).scrollTop();
    $('.yep_bg').css('top',(250+(scrolled*.3))+'px');
    $('.content').css('top',(0-(scrolled*.5))+'px');
}
	</script>
	<script>
		window.onload = function() {
		var ntf = document.getElementById('ntf');
		var child = ntf.firstChild;
		ntf.onmouseover = function(){
			child.src = 'photo/menu_ntf_white.png';
			ntf.style.backgroundColor = '#f18415';
		}
		ntf.onmouseout = function(){
			child.src = 'photo/menu_ntf_black.png';
			ntf.style.backgroundColor = '#ffffff';
		}
		}
	</script>
	<script>
	// Targets all textareas with class "txta"
let textareas = document.querySelectorAll('.txta'),
    hiddenDiv = document.createElement('div'),
    content = null;

// Adds a class to all textareas
for (let j of textareas) {
  j.classList.add('txtstuff');
}

// Build the hidden div's attributes

// The line below is needed if you move the style lines to CSS
// hiddenDiv.classList.add('hiddendiv');

// Add the "txta" styles, which are common to both textarea and hiddendiv
// If you want, you can remove those from CSS and add them via JS
hiddenDiv.classList.add('txta');

// Add the styles for the hidden div
// These can be in the CSS, just remove these three lines and uncomment the CSS
hiddenDiv.style.display = 'none';
hiddenDiv.style.whiteSpace = 'pre-wrap';
hiddenDiv.style.wordWrap = 'break-word';

// Loop through all the textareas and add the event listener
for(let i of textareas) {
  (function(i) {
    // Note: Use 'keyup' instead of 'input'
    // if you want older IE support
    i.addEventListener('input', function() {
	
      // Append hiddendiv to parent of textarea, so the size is correct
      i.parentNode.appendChild(hiddenDiv);
      
      // Remove this if you want the user to be able to resize it in modern browsers
      i.style.resize = 'none';
      
      // This removes scrollbars
      i.style.overflow = 'hidden';

      // Every input/change, grab the content
      content = i.value;

      // Add the same content to the hidden div
      
      // This is for old IE
      content = content.replace(/\n/g, '<br>');
      
      // The <br ..> part is for old IE
      // This also fixes the jumpy way the textarea grows if line-height isn't included
      hiddenDiv.innerHTML = content + '<br style="line-height: 3px;">';

      // Briefly make the hidden div block but invisible
      // This is in order to read the height
      hiddenDiv.style.visibility = 'hidden';
      hiddenDiv.style.display = 'block';
      i.style.height = hiddenDiv.offsetHeight + 'px';

      // Make the hidden div display:none again
      hiddenDiv.style.visibility = 'visible';
      hiddenDiv.style.display = 'none';
    });
  })(i);
}
</script>