<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		
		<title>Edit Startup</title>
		
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">
		<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="css/style.css">
		<script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
	</head>
	<body style="word-wrap: break-word;">
		<div class="yep_bg"><img src="photo/yep_bg.png"></div>
		
		<header class="sticky-top" style="background-color: white">
			<nav class="main-menu">
				<div class="menu_block">
					<a class="menu_yep" href="#"><img src="photo/yep.png" alt="Перейти до головної сторінки" height="40"></a>
					<a class="menu_item" href="#">YEP!STARTER</a>
					<a class="menu_item" href="#">STARTAP CLUB NURE</a>
					<a class="menu_item" href="Startups.html">СТАРТАПИ</a>
					<a class="menu_item" href="#">ПОДІЇ</a>
					<div class="menu_item sub_item">
						<a href="#">startuper2000 <img src="photo/temp_profile.jpg" height="20" style="border-radius: 30px; margin-left: 5px;"></a>
						<div class="submenu">
							<a class="submenu_item" href="#">МІЙ ПРОФІЛЬ</a>
							<a class="submenu_item" href="#">МОЇ СТАРТАПИ</a>
							<a class="submenu_item" href="#">МОЇ ПОДІЇ</a>
							<a class="submenu_item" href="login.html">ВИХІД</a>
						</div>
					</div>
					<a id="ntf" class="menu_ntf" href="#"><img src="photo/menu_ntf_black.png" height="20"></a>	
				</div>
			</nav>
		</header>
		
		<div class="content">
			<h2 class="text-center">РЕДАГУВАННЯ СТАРТАПУ</h4>
			<form method="POST" onsubmit="saveStartup(event)">

				<div class="group">      
					<input id="titleInp" type="text" required>
					<span class="highlight"></span>
					<span class="bar"></span>
					<label>Назва стартапу</label>
				</div>
				
				<div class="file-upload">
					<button class="file-upload-btn" type="button" onclick="$('.file-upload-input').trigger( 'click' )">Завантажити зображення</button>
					<input class="file-upload-input" type='file' onchange="readURL(this);" accept="image/*" />
					<div class="image-upload-wrap" style="display:none">
						<div class="image-title-wrap">
							<span class="image-title">Uploaded Image</span>
							<button type="button" onclick="removeUpload()" class="remove-image">X</button>
						</div>
						<img class="file-upload-image" src="#" alt="your image"/>
					</div>
				</div>
					
				<div class="group">      
					<textarea id="descriptionInp" class="txta" name="comment" required></textarea>
					<span class="highlight"></span>
					<span class="bar"></span>
					<label>Опишіть мету та основні положення стартапу та засоби необхідні для її реалізації.</label>
				</div>
				
				<!--<div class="group">      
					<input id="titleInp"type="text" required>
					<span class="highlight"></span>
					<span class="bar"></span>
					<label>Посилання на бізнес-модель CANVAS</label>
				</div>-->
				
				
				<h4 style="margin-bottom: 30px;" >Контактна інформація</h4>
				
				<h5 class="fas fa-globe contact-icon"></h5>
				<div class="group contact">      
					<input id="websiteInp" type="text" required>
					<span class="highlight"></span>
					<span class="bar"></span>
					<label>Адреса сайту</label>
				</div>
				
				<h5 class="fas fa-phone contact-icon"></h5>
				<div class="group contact">      
					<input id="phoneInp" type="text" required>
					<span class="highlight"></span>
					<span class="bar"></span>
					<label>Телефон</label>
				</div>
				
				<h5 class="far fa-envelope contact-icon"></h5>
				<div class="group contact">      
					<input id="emailInp" type="text" required>
					<span class="highlight"></span>
					<span class="bar"></span>
					<label>E-mail</label>
				</div>
				
	
				<div class="form-group">
					<button type="submit" class="btn btn-create btn-block">Зберегти</button>
				</div>
			</form>
		</div>
	</body>
	
	<script>
		var title, foundationYear, publicationDate, photo, description, website, phone, email;
		var str = window.location.search.split('id=');
		if (str.length != 1 ? str[1].match(/\d+/) != null : false) 
			id = +str[1];
		/*else
			window.location.href = "Startups.html";*/

		fetch('http://eliasb13-001-site1.itempurl.com/api/startups/startup?id=' + id)
			.then(handleResponse)
			.then(function(data) {
				document.getElementById('titleInp').value = data.title; // + загрузка фото
				document.getElementById('descriptionInp').value = data.description;
				document.getElementById('websiteInp').value = data.website;
				document.getElementById('phoneInp').value = data.phone;
				document.getElementById('emailInp').value = data.email;
				foundationYear = data.foundationYear;
				publicationDate = data.publicationDate;
			});
			
		function handleResponse(response) {
			return response.text().then(text => {
				const data = text && JSON.parse(text);

				if (!response.ok) {
					const error = (data && data.message) || response.statusText;

					return Promise.reject(error);
				}

				return data;
			});
		}
		
		function saveStartup(event) { // connect to post
			event.preventDefault();
	
			title = document.getElementById("titleInp").value;
			description = document.getElementById("descriptionInp").value;
			website = document.getElementById("websiteInp").value;
			phone = document.getElementById("phoneInp").value;
			email = document.getElementById("emailInp").value;

			if(title && description) { // add some validation
				const requestOptions = {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify( { startupId: id, 
											title: title, 
											foundationYear: foundationYear, 
											publicationDate: publicationDate,
											photo: "null", // edit photo
											description: description,
											website: website,
											phone: phone,
											email: email
										})
				};

			fetch(window.env.apiUrl /*right api*/, requestOptions)
				.then(handleResponse)
				.then(data => alert(JSON.stringify(data)));
			}
		}

	</script>
	
	
	<script>
	$(window).bind('scroll',function(e){
    parallaxScroll();
});
 
function parallaxScroll(){
    var scrolled = $(window).scrollTop();
    $('.yep_bg').css('top',(250+(scrolled*.3))+'px');
    $('.content').css('top',(0-(scrolled*.5))+'px');
}
	</script>
	<script>
		window.onload = function() {
		var ntf = document.getElementById('ntf');
		var child = ntf.firstChild;
		ntf.onmouseover = function(){
			child.src = 'photo/menu_ntf_white.png';
			ntf.style.backgroundColor = '#f18415';
		}
		ntf.onmouseout = function(){
			child.src = 'photo/menu_ntf_black.png';
			ntf.style.backgroundColor = '#ffffff';
		}
		}
	</script>
	<script>
	// Targets all textareas with class "txta"
let textareas = document.querySelectorAll('.txta'),
    hiddenDiv = document.createElement('div'),
    content = null;

// Adds a class to all textareas
for (let j of textareas) {
  j.classList.add('txtstuff');
}

// Build the hidden div's attributes

// The line below is needed if you move the style lines to CSS
// hiddenDiv.classList.add('hiddendiv');

// Add the "txta" styles, which are common to both textarea and hiddendiv
// If you want, you can remove those from CSS and add them via JS
hiddenDiv.classList.add('txta');

// Add the styles for the hidden div
// These can be in the CSS, just remove these three lines and uncomment the CSS
hiddenDiv.style.display = 'none';
hiddenDiv.style.whiteSpace = 'pre-wrap';
hiddenDiv.style.wordWrap = 'break-word';

// Loop through all the textareas and add the event listener
for(let i of textareas) {
  (function(i) {
    // Note: Use 'keyup' instead of 'input'
    // if you want older IE support
    i.addEventListener('input', function() {
	
      // Append hiddendiv to parent of textarea, so the size is correct
      i.parentNode.appendChild(hiddenDiv);
      
      // Remove this if you want the user to be able to resize it in modern browsers
      i.style.resize = 'none';
      
      // This removes scrollbars
      i.style.overflow = 'hidden';

      // Every input/change, grab the content
      content = i.value;

      // Add the same content to the hidden div
      
      // This is for old IE
      content = content.replace(/\n/g, '<br>');
      
      // The <br ..> part is for old IE
      // This also fixes the jumpy way the textarea grows if line-height isn't included
      hiddenDiv.innerHTML = content + '<br style="line-height: 3px;">';

      // Briefly make the hidden div block but invisible
      // This is in order to read the height
      hiddenDiv.style.visibility = 'hidden';
      hiddenDiv.style.display = 'block';
      i.style.height = hiddenDiv.offsetHeight + 'px';

      // Make the hidden div display:none again
      hiddenDiv.style.visibility = 'visible';
      hiddenDiv.style.display = 'none';
    });
  })(i);
}
	</script>
<script>
	// Upload startup image
	function readURL(input) {
		if (input.files && input.files[0]) {

			var reader = new FileReader();

			reader.onload = function (e) {
				$('.file-upload-image').attr('src', e.target.result);
				$('.image-upload-wrap').show();
				$('.image-title').html(input.files[0].name);
			};

			reader.readAsDataURL(input.files[0]);

		}  else {
			$('.image-upload-wrap').hide();
		}
	}

	function removeUpload(){
		$('.file-upload-input').replaceWith($('.file-upload-input').clone());
		$('.image-upload-wrap').hide();
	}
</script>